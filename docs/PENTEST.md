# Penetration Testing Documentation

## Overview

This document outlines the penetration testing procedures and findings for Code Translator.

## Scope

### In-Scope Assets

- **Web Application**: https://codetranslator.app
- **API Endpoints**: /api/*
- **Authentication flows**: Session management, BYOK mode
- **Payment processing**: Stripe integration (test mode only)

### Out-of-Scope

- Third-party services (OpenAI, Google, Anthropic APIs)
- Stripe production systems
- Physical security
- Social engineering

## Testing Methodology

### 1. Reconnaissance

- [ ] Subdomain enumeration
- [ ] Technology fingerprinting
- [ ] API endpoint discovery
- [ ] SSL/TLS configuration analysis

### 2. Authentication Testing

- [ ] Session token analysis (entropy, predictability)
- [ ] Session fixation/hijacking attempts
- [ ] Brute force protection verification
- [ ] Cookie security attributes
- [ ] API key validation bypass attempts

### 3. Authorization Testing

- [ ] Horizontal privilege escalation
- [ ] Vertical privilege escalation
- [ ] IDOR vulnerabilities in credit system
- [ ] API scope enforcement

### 4. Input Validation

- [ ] SQL injection (via translated code)
- [ ] XSS (stored, reflected, DOM-based)
- [ ] Command injection
- [ ] Prompt injection attacks
- [ ] Path traversal

### 5. API Security

- [ ] Rate limiting enforcement
- [ ] Input validation (Zod schemas)
- [ ] Error handling (information disclosure)
- [ ] Authentication bypass attempts
- [ ] CORS misconfiguration

### 6. Business Logic

- [ ] Credit manipulation
- [ ] Race conditions in credit consumption
- [ ] Checkout flow tampering
- [ ] Idempotency key bypass

## Tools

- OWASP ZAP (automated scanning)
- Burp Suite (manual testing)
- Nuclei (vulnerability scanning)
- custom scripts (prompt injection testing)

## Test Environment

```bash
# Local testing setup
export TARGET_URL=http://localhost:3000
export SESSION_SECRET=test-secret-for-pentest

# Run development server
bun run dev

# Optional: Run with debug logging
DEBUG=* bun run dev
```

## Findings Template

### Finding: [Title]

- **Severity**: Critical / High / Medium / Low / Informational
- **CVSS Score**: X.X
- **CWE ID**: CWE-XXX
- **Status**: Open / Fixed / Accepted Risk

#### Description

[Detailed description of the vulnerability]

#### Steps to Reproduce

1. Step one
2. Step two
3. Step three

#### Impact

[What an attacker could achieve]

#### Remediation

[Recommended fix]

#### Evidence

```
[Screenshots, logs, or payloads]
```

---

## Previous Findings

### Fixed Issues

1. **CORS Misconfiguration** (Medium) - Fixed in v1.0.1
   - Added strict origin validation
   
2. **Missing Rate Limiting** (High) - Fixed in v1.0.2
   - Implemented per-session rate limiting

3. **Information Disclosure in Errors** (Low) - Fixed in v1.0.3
   - Standardized error responses with requestId only

### Accepted Risks

1. **Monaco Editor CDN** (Low)
   - Third-party dependency, mitigated with SRI
   
2. **Client-side API Key Storage** (Medium)
   - Required for BYOK mode, encrypted in localStorage

## Retesting Schedule

- Quarterly automated scans
- Annual manual penetration tests
- After major feature releases

## Contact

Security issues: security@codetranslator.app
Bug bounty: Coming soon

## Revision History

| Date | Version | Author | Changes |
|------|---------|--------|---------|
| 2026-01-06 | 1.0 | Security Team | Initial documentation |
